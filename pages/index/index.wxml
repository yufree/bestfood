<view class="container">
  <!-- é¡¶éƒ¨åŒºåŸŸ -->
  <view class="header">
    <view class="brand">
      <text class="brand-title">æ—¶ä»¤æœè”¬åŠ©æ‰‹</text>
      <text class="brand-subtitle">æŸ¥è¯¢å½“å‰æ—¶é—´ä¸­å›½å„åœ°åº”å­£æ°´æœè”¬èœ</text>
    </view>
  </view>

  <!-- ç­›é€‰åŒºåŸŸ -->
  <view class="filters">
    <view class="filter-section">
      <text class="filter-label">å“ç±»ç­›é€‰</text>
      <view class="filter-chips">
        <view
          class="chip {{selectedCategory === 'all' ? 'chip-active' : ''}}"
          bindtap="onCategoryChange"
          data-value="all"
        >
          å…¨éƒ¨
        </view>
        <view
          class="chip {{selectedCategory === 'fruit' ? 'chip-active' : ''}}"
          bindtap="onCategoryChange"
          data-value="fruit"
        >
          æ°´æœ
        </view>
        <view
          class="chip {{selectedCategory === 'vegetable' ? 'chip-active' : ''}}"
          bindtap="onCategoryChange"
          data-value="vegetable"
        >
          è”¬èœ
        </view>
      </view>
    </view>

    <view class="filter-section">
      <text class="filter-label">æ¥æºç­›é€‰</text>
      <view class="filter-chips">
        <view
          class="chip {{selectedOrigin === 'all' ? 'chip-active' : ''}}"
          bindtap="onOriginChange"
          data-value="all"
        >
          å…¨éƒ¨
        </view>
        <view
          class="chip {{selectedOrigin === 'domestic' ? 'chip-active' : ''}}"
          bindtap="onOriginChange"
          data-value="domestic"
        >
          å›½äº§
        </view>
        <view
          class="chip {{selectedOrigin === 'imported' ? 'chip-active' : ''}}"
          bindtap="onOriginChange"
          data-value="imported"
        >
          è¿›å£
        </view>
      </view>
    </view>

    <view class="date-section">
      <text class="filter-label">æŸ¥è¯¢æ—¥æœŸ</text>
      <picker mode="date" value="{{selectedDate}}" bindchange="onDateChange">
        <view class="date-picker">
          <text>{{selectedDateFormatted}}</text>
          <text class="arrow">â–¼</text>
        </view>
      </picker>
    </view>
  </view>

  <!-- ä»Šæ—¥æœ€ä½³æ¨è -->
  <view class="section" wx:if="{{highlightItems.length > 0}}">
    <view class="section-header">
      <text class="section-title">ä»Šæ—¥æœ€ä½³æ¨è</text>
      <text class="section-subtitle">{{summaryText}}</text>
    </view>
    <view class="card-list">
      <view
        class="item-card"
        wx:for="{{highlightItems}}"
        wx:key="id"
        bindtap="onItemTap"
        data-item="{{item}}"
      >
        <view class="card-header">
          <view class="card-title">
            <text class="emoji">{{item._emoji}}</text>
            <text class="name">{{item.name}}</text>
          </view>
          <view class="tag tag-{{item.category}}">
            {{item.category === 'fruit' ? 'æ°´æœ' : 'è”¬èœ'}}
          </view>
        </view>

        <view class="card-tags">
          <view class="tag tag-peak">å½“å­£ Â· é«˜å³°ï¼š{{item._matchedSeason.peak.join('ã€')}}æœˆ</view>
          <view class="tag" wx:if="{{item.isImported}}">è¿›å£å¯é€‰</view>
          <view class="tag">{{item._varietyTag}}</view>
          <view
            class="tag"
            wx:for="{{item.nutritionTags.slice(0, 3)}}"
            wx:key="*this"
          >
            {{item}}
          </view>
        </view>

        <view class="card-footer">
          <text class="score-text">ç»¼åˆæ¨èï¼š</text>
          <text class="score">{{item._score}}</text>
          <text class="score-text">/5</text>
        </view>
      </view>
    </view>
  </view>

  <!-- å³å°†ä¸Šå¸‚ -->
  <view class="section" wx:if="{{comingSoonItems.length > 0}}">
    <view class="section-header">
      <text class="section-title">å³å°†ä¸Šå¸‚</text>
      <text class="section-subtitle">æœªæ¥ 30 å¤©å†…ä¸Šå¸‚çš„ç¾å‘³</text>
    </view>
    <view class="card-list">
      <view
        class="item-card"
        wx:for="{{comingSoonItems}}"
        wx:key="id"
        bindtap="onItemTap"
        data-item="{{item}}"
      >
        <view class="card-header">
          <view class="card-title">
            <text class="emoji">{{item._emoji}}</text>
            <text class="name">{{item.name}}</text>
          </view>
          <view class="tag tag-{{item.category}}">
            {{item.category === 'fruit' ? 'æ°´æœ' : 'è”¬èœ'}}
          </view>
        </view>

        <view class="card-tags">
          <view class="tag" style="background: #e0f2fe; color: #0284c7;">ğŸ“… {{item._comingSoonDate}} ä¸Šå¸‚</view>
          <view class="tag">{{item._varietyTag}}</view>
        </view>

        <view class="card-footer">
          <text class="score-text">åŸºç¡€æ¨èï¼š</text>
          <text class="score">{{item._score}}</text>
          <text class="score-text">/5</text>
        </view>
      </view>
    </view>
  </view>

  <!-- å½“å­£å…¨éƒ¨æœè”¬ -->
  <view class="section">
    <view class="section-header">
      <text class="section-title">å½“å­£å…¨éƒ¨æœè”¬</text>
      <text class="section-subtitle">æŒ‰æ¨èç¨‹åº¦æ’åº</text>
    </view>

    <view class="card-list" wx:if="{{allItems.length > 0}}">
      <view
        class="item-card"
        wx:for="{{allItems}}"
        wx:key="id"
        bindtap="onItemTap"
        data-item="{{item}}"
      >
        <view class="card-header">
          <view class="card-title">
            <text class="emoji">{{item._emoji}}</text>
            <text class="name">{{item.name}}</text>
          </view>
          <view class="tag tag-{{item.category}}">
            {{item.category === 'fruit' ? 'æ°´æœ' : 'è”¬èœ'}}
          </view>
        </view>

        <view class="card-tags">
          <view class="tag tag-peak">å½“å­£ Â· é«˜å³°ï¼š{{item._matchedSeason.peak.join('ã€')}}æœˆ</view>
          <view class="tag" wx:if="{{item.isImported}}">è¿›å£å¯é€‰</view>
          <view class="tag">{{item._varietyTag}}</view>
          <view
            class="tag"
            wx:for="{{item.nutritionTags.slice(0, 3)}}"
            wx:key="*this"
          >
            {{item}}
          </view>
        </view>

        <view class="card-footer">
          <text class="score-text">ç»¼åˆæ¨èï¼š</text>
          <text class="score">{{item._score}}</text>
          <text class="score-text">/5</text>
        </view>
      </view>
    </view>

    <!-- ç©ºçŠ¶æ€ -->
    <view class="empty-state" wx:if="{{allItems.length === 0 && !loading}}">
      <text>å½“å‰æ¡ä»¶ä¸‹æœªæ‰¾åˆ°æ˜æ˜¾åº”å­£çš„æ°´æœè”¬èœ</text>
      <text style="font-size: 24rpx; margin-top: 16rpx; color: #9ca3af;">
        å¯ä»¥å°è¯•è°ƒæ•´ç­›é€‰æ¡ä»¶
      </text>
    </view>
  </view>

  <!-- åŠ è½½ä¸­ -->
  <view class="loading" wx:if="{{loading}}">
    <text>åŠ è½½ä¸­...</text>
  </view>
</view>